---
title: 관계 데이터 연산
tags: 데이터베이스 도서
article_header:
type: cover
---
# [1] 관계 데이터 연산의 개념

---

> 관계 데이터 모델에서 **연산**은 원하는 데이터를 얻기 위해 릴레이션에 필요한 처리를 하는것이다.

대표적인 관계 데이터 연산

### 1. 관계 대수
### 2. 관계 해석

<br>

### 관계 대수?

---

원하는 결과를 얻기 위해 데이터를 **순차적**으로 기술하는 **절차 언어**

<br>

### 관계 해석?

---

원하는 결과를 얻기 위해 처리를 데이터를 **무엇**인지만 기술하는 **비절차 언어**

<br>

---

## Q. 관계 대수와 관계 해석은 상용화된 데이터베이스에서 사용하지 않는 **개념적** 언어인데 왜 알아야 할까?

> ### A. 새로운 데이터 언어가 제안되면 언어의 유용성 검증을 관계 대수와 관계 해석을 통해서 진행하기 때문이다.


<br><br>

# [2] 관계 대수

---

![](https://raw.githubusercontent.com/jickDo/picture/master/Book/DB/관계대수연산자종류.png)

위 사진에서 알 수 있듯이 관계 대수 연산자는 크게 두가지로 구분된다.

### 1. 일반 집합 연산자

### 2. 순수 관계 연산자

<br> <br>

## 1-1. 일반 집합 연산자

---

**일반 집합 연산자**는 릴레이션이 **투플의 집합**이라는 개념을 이용하는데 이는 수학의 집합 관련 연산자를 이용하는 것이다.

<br>

| 연산자      | 기호  | 표현  | 의미                                                |
|----------|-----|-----|---------------------------------------------------|
| 합집합      | ∪   | R∪S | 릴레이션 R과 S의 합집합을 반환                                |
| 교집합      | ∩   | R∩S | 릴레이션 R과 S의 교집합을 반환                                |
| 차집합      | -   | R-S | 릴레이션 R과 S의 차집합을 반환                                |
| 카티션 프로덕트 | x   | RxS | 릴레이션 R의 각 투플과 릴레이션 S의 각 투플을 모두 연결하여 만든 새로운 투플을 반환 |

일반 집합 연산자에 속하는 합집합, 교집합, 차집합, 카티션 프로덕트는 수학의 집합 연산에 대응하면 쉽게 이해가능하다.

<br>

## 일반 집합 연산자 두가지 제약조건

---

> ### 1. 연산을 위해 두가지 피연산자가 필요하다.
> ### 2. 카티션 프로덕트를 제외한 나머지 연산자는 합병 가능해야 한다.

<br>

### Q. 합병 가능이란?

> A. 두 릴레이션의 차수와 대응되는 속성의 도메인이 같으면 된다.

<br><br>

## 1-1-1. 합집합

---

### R

| 번호  | 이름  |
|-----|-----|
| 100 | 정소화 |
| 200 | 김선우 |
| 300 | 고명석 |

### S

| 번호  | 이름  |
|-----|-----|
| 100 | 정소화 |
| 101 | 채광주 |
| 102 | 김수진 |

### R∪S

| 번호  | 이름  |
|-----|-----|
| 100 | 정소화 |
| 200 | 김선우 |
| 300 | 고명석 |
| 101 | 채광주 |
| 102 | 김수진 |

위 릴레이션 **R** 그리고 **S**를 합집합 연산하게 되면 **R∪S** 의 결과를 확인할 수 있다.

두 릴레이션의 합친것과 같은 결과이며 중복에 대해서는 릴레이션은 중복이 있으면 안된다는 특성에 따라 제거하여 표현한다.

<br><br>

## 1-1-2. 교집합

---

### R

| 번호  | 이름  |
|-----|-----|
| 100 | 정소화 |
| 200 | 김선우 |
| 300 | 고명석 |

### S

| 번호  | 이름  |
|-----|-----|
| 100 | 정소화 |
| 101 | 채광주 |
| 102 | 김수진 |

### R∩S

| 번호  | 이름  |
|-----|-----|
| 100 | 정소화 |

위 릴레이션 **R** 그리고 **S**를 교집합 연산하게 되면 **R∩S** 의 결과를 확인할 수 있다.

특별한 점은 없으니 넘아간다.

<br><br>

## 1-1-3. 차집합

---

### R

| 번호  | 이름  |
|-----|-----|
| 100 | 정소화 |
| 200 | 김선우 |
| 300 | 고명석 |

### S

| 번호  | 이름  |
|-----|-----|
| 100 | 정소화 |
| 101 | 채광주 |
| 102 | 김수진 |

### R-S

| 번호  | 이름  |
|-----|-----|
| 200 | 김선우 |
| 300 | 고명석 |

### S-R

| 번호  | 이름  |
|-----|-----|
| 101 | 채광주 |
| 102 | 김수진 |

위 릴레이션 **R** 그리고 **S**를 차집합 연산하게 되면 **R-S**, **S-R** 의 결과를 확인할 수 있다.

차집합은 특이한점은

> 피연산자의 순서에 따라 결과 릴레이션이 달라진다.

<br><br>

## 1-1-4. 카티션 프로덕트

---

### R

| 번호  | 이름  |
|-----|-----|
| 100 | 정소화 |
| 200 | 김선우 |
| 300 | 고명석 |

### S

| 번호  | 나이  |
|-----|-----|
| 100 | 40  |
| 101 | 30  |
| 102 | 25  |

### R X S

| R.번호 | R.이름 | S.번호 | S.나이 |
|------|------|------|------|
| 100  | 정소화  | 100  | 40   |
| 100  | 정소화  | 101  | 30   |
| 100  | 정소화  | 102  | 25   |
| 200  | 김선우  | 100  | 40   |
| 200  | 김선우  | 101  | 30   |
| 200  | 김선우  | 102  | 25   |
| 300  | 고명석  | 100  | 40   |
| 300  | 고명석  | 101  | 30   |
| 300  | 고명석  | 102  | 25   |

위 릴레이션 **R** 그리고 **S**를 카티션 프로덕트 연산하게 되면 **RXS** 의 결과를 확인할 수 있다.

카티션 프로덕트는 두개의 릴레이션의 속한 투플을 모두 연결하여 가능한 경우의수를 모두 보여주는 것으로 만들어진다.


<br> <br>

## 1-2. 순수 관계 연산자

---

**순수 관계 연산자**는 릴레이션의 **구조**와 **특성** 을 이용하는 연산자이다.

<br>

| 연산자    | 기호  | 표현  | 의미                                             |
|--------|-----|-----|------------------------------------------------|
| 셀렉트 σ  | σ   | RσS | 릴레이션 R에서 조건을 만족하는 투플들을 반환                      |
| 프로젝트 Π | Π   | RΠS | 릴레이션 R에서 주어진 속성들의 값으로만 구성된 투플들을 반환             |
| 조인  ⋈  | ⋈   | R⋈S | 공통 속성을 이용해 릴레이션 R과 S의 투플들을 연결하여 만든 새로운 투플들을 반환 |
| 디비전 %  | %   | R%S | 릴레이션 S의 모든 투플과 관련이 있는 릴레이션 R의 투플들을 반환          |

순수 관계 연산자에 속하는 셀렉트, 프로젝트, 조인, 디비전은 릴레이션의 **구조**와 **특성**을 이용하는 연산자이다.

<br><br>

## 1-2-1. 셀렉트

---

셀렉트 연산은 릴레이션에서 주어진 조건을 만족하는 투플만 선택하여 결과 릴레이션을 새로 구성한다.
쉽게 생각하여 조건식을 이용해서 부분집합을 새로 구성하는 것이다.

<br>

### 고객 릴레이션

| 고객아이디  | 고객이름 | 나이  | 등급     | 직업  | 적립금  |
|--------|------|-----|--------|-----|------|
| apple  | 김현준  | 20  | gold   | 학생  | 1000 |
| banana | 정소화  | 25  | vip    | 간호사 | 2500 |
| carrot | 원유선  | 28  | gold   | 교사  | 4500 |
| orange | 정지영  | 22  | silver | 학생  | 0    |

위 고객릴레이션에서 셀렉트 연산을 진행해보겠다.

> 고객 릴레이션에서 등급이 gold인 투플을 검색한다.
>
> σ 등급='gold'(고객) or where 등급 = 'gold'

로 셀렉트 연산을 수행할수 있다.

<br>

### 결과 릴레이션

| 고객아이디  | 고객이름 | 나이  | 등급   | 직업  | 적립금  |
|--------|------|-----|------|-----|------|
| apple  | 김현준  | 20  | gold | 학생  | 1000 |
| carrot | 원유선  | 28  | gold | 교사  | 4500 |

결과는 위처럼 등급이 gold인 모든 튜플이 검색된다.
결과 릴레이션처럼 행에 대한 검색을 수행하기 때문에 **수평적 부분집합**을 구성하는 **수평적 연산자**라고도 한다.

<br><br>

## 1-2-2. 프로젝트

---

프로젝트 연산은 릴레이션에서 선택한 속성에 해당하는 값으로 새로운 결과 릴레이션을 구성하는 것이다.

<br>

### 고객 릴레이션

| 고객아이디  | 고객이름 | 나이  | 등급     | 직업  | 적립금  |
|--------|------|-----|--------|-----|------|
| apple  | 김현준  | 20  | gold   | 학생  | 1000 |
| banana | 정소화  | 25  | vip    | 간호사 | 2500 |
| carrot | 원유선  | 28  | gold   | 교사  | 4500 |
| orange | 정지영  | 22  | silver | 학생  | 0    |

위 릴레이션에서 프로젝트를 수행하겠다.

> 고객 릴레이션에서 고객이름, 등급, 적립금을 검색한다.
>
> Π 고객이름, 등급, 적립금(고객) or 고객[고객이름,등급,적립금]

로 프로젝트 연산을 수행할 수 있다.

<br>

### 결과 릴레이션

| 고객이름 | 등급     | 적립금  |
|------|--------|------|
| 정소화  | gold   | 1000 |
| 김선우  | vip    | 2500 |
| 고명석  | gold   | 4500 |
| 김용욱  | silver | 0    |

결과는 고객이름, 등급, 적립금에 해당하는 속성만 구성하여 반환하게 된다.
결과 릴레이션처럼 열에 대한 검색을 수행하기 때문에 **수직적 부분집합**을 구성하는 **수직적 연산자**라고도 한다.

<br><br>

## 1-2-3. 디비전

---

디비전 연산은 릴레이션에서 조건에 해당하는 값을 릴레이션 내에서 모두가지고 있는 속성에 대해서 조건을 제외한 값을 검색해주는 것이다.
설명보다는 예시가 이해하기 편할것이다.

<br>

### 주문내역 릴레이션

| 주문고객   | 제품이름  | 제조업체 |
|--------|-------|------|
| apple  | 진짜우동  | 직찬식품 |
| carrot | 맛있는파이 | 강서과자 |
| banana | 그대로만두 | 한빛식품 |
| apple  | 그대로만두 | 직찬식품 |
| carrot | 그대로만두 | 직찬식품 |

### 제품1 릴레이션

| 제품이름  |
|-------|
| 진짜우동  |
| 그대로만두 |

### 주문내역 % 제품1

| 주문고객  | 제조업체 |
|-------|------|
| apple | 직찬식품 |

<br>

위의 경우 디비전을 수행하게 되면 위와같은 결과나 나온다.
진짜우동, 그대로 만두를 가진 속성은 **주문내역 릴레이션**내에서 고객이름이 **apple**이고, 제조업체가 **직찬식품**인 튜플만 있다.
따라서, 위와같은 결과가 나온다.

<br><br>

## 1-2-4. 조인

---

조인 연산은 릴레이션 하나로 원하는 데이터를 얻을 수 없어 관계가 있는 여러 릴레이션을 함께 사용해야 하는 경우 이용한다.

> **조인 속성**을 이용해서 두 릴레이션을 조합하여 하나의 결과 릴레이션을 구성한다. 조인 속성은 두 릴레이션이 가지고 있는 공통 속성이다.
>
<br>

## 조인의 종류

조인의 경우에는 파생되는 조인이 여러 종류가 있고, 이중 다섯가지를 다루어 볼것이다.

### 1. 세타 조인

### 2. 동등 조인

### 3. 자연 조인

### 4. 외부 조인

### 5. 세미 조인

---

<br>

## 1. 세타 조인

---

세타 조인이랑 두 릴레이션에서 공통된 속성을 기준으로 비교 연산자 (=,>,<,=<,=>)등을 사용하여 조건을 만족하는 튜플을 결합하는 것이다.

### 고객 릴레이션

| 고객아이디  | 고객이름 | 나이  | 등급     |
|--------|------|-----|--------|
| apple  | 김현준  | 20  | gold   |
| banana | 정소화  | 25  | vip    |
| carrot | 원유선  | 28  | gold   |
| orange | 정지영  | 22  | silver |

### 주문 릴레이션

| 주문번호 | 고객아이디  | 주문제품  | 수량  |
|------|--------|-------|-----|
| 1001 | apple  | 진짜우동  | 10  |
| 1002 | carrot | 맛있는파이 | 5   |
| 1003 | banana | 그대로만두 | 11  |

### 고객⋈주문

| 고객.고객아이디 | 고객.고객이름 | 고객.나이 | 고객.등급 | 주문.주문번호 | 주문.고객아이디 | 주문.주문제품 | 주문.수량 |
|----------|---------|-------|-------|---------|----------|---------|-------|
| apple    | 김현준     | 20    | gold  | 1001    | apple    | 진짜우동    | 10    |
| banana   | 정소화     | 25    | vip   | 1002    | carrot   | 맛있는파이   | 5     |
| carrot   | 원유선     | 28    | gold  | 1003    | banana   | 그대로만두   | 11    |

고객과 주문 릴레이션을 세타 조인하게 되면 위와 같은 결과를 얻을 수있다. 물론 비교 연산자를 =를 사용하였다.
속성은 첫 릴레이션의 이름에 "." 속성명을 사용하였다.

<br>

## 2. 동등조인

---

동등조인은 세타조인의 한종류로 비교연산자를 "="를 사용한 것이다. 일반적으로 조인이라고 하면 동등조인을 나타낸다.

예시는 위와같기 때문에 생략한다.

<br>

## 3. 자연조인

---

자연조인은 조인을 하는 **조인 속성**에 대해서 중복이 발생할 경우 중복 속성을 제거하고 표현한 것이다.
위 세타조인을 자연조인 하면 아래와 같은 결과가 나온다.

| 고객아이디  | 고객이름 | 나이  | 등급   | 주문번호 | 주문제품  | 수량  |
|--------|------|-----|------|------|-------|-----|
| apple  | 김현준  | 20  | gold | 1001 | 진짜우동  | 10  |
| banana | 정소화  | 25  | vip  | 1002 | 맛있는파이 | 5   |
| carrot | 원유선  | 28  | gold | 1003 | 그대로만두 | 11  |

기존 두번 표현되던 고객아이디를 지웠다. 중복속성이 존재하지 않기 때문에 릴레이션명을 표현할 필요도 없다.

<br>

## 4. 외부조인

---

널값이 발생하는 튜플을 나타내기 위해 사용하는 방식이다.

외부조인을 사용하면 기존 없어지던 튜플에 대해서도 null을 사용함으로써 표현이 가능해진다.

외부조인에는 크게 3가지가 있다.

### 1. 왼쪽 외부 조인

### 2. 오른쪽 외부 조인

### 3. 완전 외부 조인

<br><br>

### R

| A   | B   | C   |
|-----|-----|-----|
| a1  | b1  | c1  |
| a2  | b2  | c2  |

### S

| C   | D   | E   |
|-----|-----|-----|
| c1  | d1  | e1  |
| c3  | d2  | e2  |

위오 같은 두개의 릴레이션에 대해 3가지 종류의 외부 조인을 사용해보겠다.

<br><br>

### 왼쪽 외부 조인

| A   | B   | C   | D    | E    |
|-----|-----|-----|------|------|
| a1  | b1  | c1  | d1   | e1   |
| a2  | b2  | c2  | null | null |

왼쪽 외부 조인은 첫번째 릴레이션(여기선 R)에 대해서 공통 속성에 대한 값이 없을 경우 기존 값을 살리고, 조인된 속성에 대해서는 **null** 로 나타낸다.

<br><br>

### 오른쪽 외부 조인

| A    | B    | C   | D   | E   |
|------|------|-----|-----|-----|
| a1   | b1   | c1  | d1  | e1  |
| null | null | c3  | d2  | e2  |

오른쪽 외부 조인은 두번째 릴레이션(여기선 S)에 대해서 공통 속성에 대한 값이 없을 경우 기존 값을 살리고, 조인된 속성에 대해서는 **null** 로 나타낸다.

<br><br>

### 완전 외부 조인

| A    | B    | C   | D    | E    |
|------|------|-----|------|------|
| a1   | b1   | c1  | d1   | e1   |
| a2   | b2   | c2  | null | null |
| null | null | c3  | d2   | e2   |

완전 외부 조인은 모든 릴레이션(여기선 R,S)에 대해서 공통 속성에 대한 값이 없을 경우 기존 값을 살리고, 조인된 속성에 대해서는 **null** 로 나타낸다.


<br>

## 5. 세미조인

---

세미 조인이란 조인을 수행할 때 한쪽 릴레이션에 대해서 조인될 속성만 추출하여 조인을 하는 것이다.

<br>

### 고객 릴레이션

| 고객아이디  | 고객이름 | 나이  | 등급     |
|--------|------|-----|--------|
| apple  | 김현준  | 20  | gold   |
| banana | 정소화  | 25  | vip    |
| carrot | 원유선  | 28  | gold   |
| orange | 정지영  | 22  | silver |

### 주문 릴레이션

| 주문번호 | 고객아이디  | 주문제품  | 수량  |
|------|--------|-------|-----|
| 1001 | apple  | 진짜우동  | 10  |
| 1002 | carrot | 맛있는파이 | 5   |
| 1003 | banana | 그대로만두 | 11  |

위처럼 두개의 릴레이션이 있을때 주문 릴레이션을 프로젝트 연산을 수행한다.

### 프로젝트 연산된 주문 릴레이션

| 고객아이디  |
|--------|
| apple  |
| carrot |
| banana |

고객아이디만 있는 릴레이션과 고객릴레이션의 조인을 하는것이 **세미 조인**이다.



