---
title: 데이터베이스 언어 SQL
tags: 데이터베이스 도서
article_header:
type: cover
---
# [1] SQL 소개

---

<br><br>

## SQL 이 뭘까?

* sql이란 관계 데이터베이스에서 표준 질의어로 많이 사용되는 언어이다. 원하는 것만 지시하기 때문에 **비절차적 언어**의 특성을 보인다.
* sql은 기능에 따라 **데이터 정의어(DDL)**, **데이터 조작어(DML)**, **데이터 제어어(DCL)** 로 나뉜다.

### 데이터 정의어(DDL)

> **테이블** 을 **생성**, **수정**, **삭제**하는 기능을 제공한다.

### 데이터 조작어(DML)

> **테이블** 에 **데이터**를 **삽입**, **수정**, **삭제**, **검색**을 수행한다.

### 데이터 제어어(DCL)

> **보안** 을 위해 데이터에 **접근** 및 **사용권한** 을 부여한다.


<br><br>

## 예시 테이블

---

### 고객 테이블

| 고객아이디  | 고객이름 | 나이   | 등급     | 직업  | 적립금  |
|--------|------|------|--------|-----|------|
| apple  | 정소화  | 20   | gold   | 학생  | 1000 |
| banana | 김선우  | 25   | vip    | 간호사 | 2500 |
| carrot | 고명석  | 28   | gold   | 교사  | 4500 |
| orange | 김용욱  | 22   | silver | 학생  | 0    |
| melon  | 성원용  | 35   | gold   | 회사원 | 5000 |
| peach  | 오형준  | NULL | silver | 의사  | 300  |
| pear   | 채광주  | 31   | silver | 회사원 | 500  |

### 제품 테이블

| 제품번호 | 제품명   | 재고량  | 단가   | 제조업체 |
|------|-------|------|------|------|
| p01  | 그냥만두  | 5000 | 4500 | 대한식품 |
| p02  | 매운쫄면  | 2500 | 5600 | 민국푸드 |
| p03  | 쿵떡파이  | 3600 | 2600 | 한빛제과 |
| p04  | 맛난초콜릿 | 1250 | 2500 | 한빛제과 |
| p05  | 얼큰라면  | 2200 | 1200 | 대한식품 |
| p06  | 통통우동  | 1000 | 1550 | 민국푸드 |
| p07  | 달콤비스킷 | 1500 | 1500 | 한빛제과 |

### 주문 테이블

| 주문번호 | 주문고객   | 주문제품 | 수량  | 배송지      | 주문일자        |
|------|--------|------|-----|----------|-------------|
| o01  | apple  | p03  | 10  | 서울시 마포구  | 2022-01-01  |
| o02  | melon  | p01  | 5   | 인천기 계양구  | 2022-01-10  |
| o03  | banana | p06  | 45  | 경기도 부천시  | 2022-01-11  |
| o04  | carrot | p02  | 8   | 부산시 금정구  | 2022-02-01  |
| o05  | melon  | p06  | 36  | 경기도 용인시  | 2022-02-20  |
| o06  | banana | p01  | 19  | 충청북도 보은군 | 2022-03-02  |
| o07  | apple  | p03  | 22  | 서울시 영등포구 | 2022-03-15  |
| o08  | pear   | p02  | 50  | 강원도 춘천시  | 2022-04-10  |
| o09  | banana | p04  | 15  | 전라남도 목포시 | 2022-04-11  |
| o10  | carrot | p03  | 20  | 경기도 안양시  | 2022-05- 22 |

<br>

> **위 3개의 테이블은 앞으로 질의에 사용할 데이터 베이스이다.**

# [2] SQL을 이용한 데이터 정의

---

<br><br>

sql의 데이터 정의 기능에는 크게 3가지로 나뉜다.

> ### 테이블 생성 : CREATE TABLE
> ### 테이블 변경 : ALTER TABLE
> ### 테이블 삭제 : DROP TABLE

<br><br>

## 2-1 테이블 생성

---

````sql
CREATE TABLE 테이블이름
(
    (1
) 속성이름 데이터 타입 [NULL 여부] [DEFAULT 기본값]
(
    2
) [PRIMARY KEY
(
    속성 리스트
)]
(
    3
) [UNIQUE
(
    속성 리스트
)]
(
    4
) [FOREIGN KET
(
    속성 리스트
) REFERENCES 테이블이름
(
    속성 리스트
)]
(
    5
) [CONSTRAINT 이름] [CHECK
(
    조건
)]
    );
````

위 넘버링은 테이블 생성시 할수 있는 일들에 대한 정의이다.
차례 대로

### 1. 테이터 속성 정의

### 2. 기본키 설정

### 3. 대체키 설정

### 4. 외래키 설정

### 5. 제약사항 설정이다

<br>

예시를 하나 들어 실제 테이블 생성 질의 문을 보게 되면

```` sql
CREATE TABLE 주문 (
    주문번호 CHAR(3) NOT NULL,
    주문고객 VARCHAR(20),
    주문제품 CHAR(3),
    수량 INT,
    배송지 VARCHAR(30),
    주문일자 DATE,
    PRIMARY KEY(주문번호),
    FOREIGN KEY(주문고객) REFERENCES 고객(고객아이디),
    FOREIGN KEY(주문제품) REFERENCES 제품(제품번호),
)
````

위 예시는

> 속성: 주문번호, 주문고객, 주문제품, 수량, 배송지, 주문일자
>
> 기본키: 주문번호
>
> 외래키: 주문고객, 주문제품

인 테이블 생성 쿼리문이다.

<br><br>

## 2-2 테이블 변경

테이블 변경은 **ALBER TABLE** 로 수행할수 있다.

````sql
ALTER TABLE 테이블이름
    ADD 속성이름 데이터타입 [NOT NULL] [DEFAULT 기본값];
````

<br><br>

기존 속성에 대한 삭제 질의문은

````sql
ALTER TABLE 테이블이름 DROP COLUMN 속성이름;
````

<br><br>

새로운 제약조건의 추가 질의문은

````sql
ALTER TABLE 테이블이름
    ADD CONSTRAINT 제약조건이름 제약조건내용;
````

<br><br>

기존 제약조건의 삭제 질의문은

````sql
ALTER TABLE 테이블이름 DROP CONSTRAINT 제약조건이름;
````

<br><br>

## 2-3 테이블 삭제

기존 테이블을 삭제하는 질의문은

````sql
DTOP
TABLE 테이블이름
````

<br><br>

# [3] SQL을 이용한 데이터 조작

---

sql의 데이터 조작 기능에는 크게 3가지로 나뉜다.

> ### 테이블 검색 : SELECT
> ### 테이블 삽입 : INSERT
> ### 테이블 수정 : UPDATE
> ### 테이블 삭제 : DELETE

<br><br>

## 3-1 데이터 검색

---

기본적인 데이터 검색 질의문의 형태는 아래와 같다.

````sql
SELECT [ ALL | DISTINCT ] 속성리스트
FROM 테이블_리스트;
````

이를 쉽게 풀어보자면,
> SELECT (검색할속성들리스트) FROM (테이블리스트)

예시로 고객 테이블에서 고객아이디, 고객이름, 등급 속성을 검색하게 되면

> SELECT 고객아이디, 고객이름, 등급
>
> FROM 고객;

이 된다.

여기서 ALL, DISTINCT 속성은 각각 중복을 허용할건지 중복을 허용하지 않을건지에 대한 속성이다.
기본적으로 ALL이 기본값이지만 명시적으로 나타내기 위해선 사용하면 좋다.

<br><br>

### 조건 검색

---

검색에 조건 기능을 추가 하려면 **WHERE** 질의를 사용하면 된다.

````sql
SELECT [ ALL | DISTINCT ] 속성리스트
FROM 테이블_리스트;
[WHERE 조건]
````

조건에는 **비교 연산자** 와 **논리 연산자**가 올 수 있다.

<br><br>

### LIKE 검색

---

검색 조건을 부분적으로 알고 있다면 LIKE 키워드를 이용할 수 있다.

LIKE 키워드와 함께 사용할 수 있는 기호는 아래와 같다.

| 기호  | 설명        |
|-----|-----------|
| %   | 0개 이상의 문자 |
| _   | 1개의 문자    |

<br>

LIKE 키워드의 예시로는

| 사용 예         | 설명                  |
|--------------|---------------------|
| LIKE'데이터%'   | 데이터로 시작하는 문자열       |
| LIKE'%데이터'   | 데이터로 끝나는 문자열        |
| LIKE'%데이터%'  | 데이터가 포함된 문자열        |
| LIKE'데이터___' | 데이터로 시작하는 6자길이의 문자열 |
| LIKE'__한%'   | 세번째 글자가 "한"인 문자열    |

<br><br>

### NULL 검색

---

검색 조건에서 특정 속성의 값이 널 값인지를 비교하려면 두가지 키워드를 사용할 수 있다.

### 1. IS NULL

### 2. IS NOT NULL

<br><br>

### 정렬 검색

---

SELECT 키워드를 이용한 검색반환은 DBMS가 정한 순서대로 출력되지만 이를 사용자가 쿼리문을 이용해서 조정 할 수 있다.
여기서 사용하는 키워드가 바로 **ORDER BY** 속성이다.

````sql
SELECT [ ALL | DISTINCT ] 속성리스트
FROM 테이블_리스트;
[WHERE 조건]
[ORDER BY 속성리스트 [ ASC | DESC]];
````

여기서 정렬하고자 하는 속성을 ORDER BY 뒤에 적고, ASC(ASCENDING)나 DESC(DESCENDING) 명시하면 된다.

<br>

여기서 한번더 생각해볼 부분은 두개의 정렬 조건을 가지는 경우이다.

가령 주문제품에 대해서 1차적인 정렬을 한 경우에 대해서 같은 주문제품이 등장하는 경우에 대한 정렬도 존재하면 아래와 같이 작성하면 된다.

````sql
ORDER BY 주문제품 ASC, 수량 DESC;
````

<br><br>

### 집계 함수 검색

---

특정 속성 값을 통계적으로 계산한 결과를 검색하기 위해 집계 함수를 사용하게 된다.
종류는 아래와 같다.

| 함수    | 의미        | 사용 가능한 속성의 타입 |
|-------|-----------|---------------|
| COUNT | 속성 값의 개수  | 모든 데이터        |
| MAX   | 속성 값의 최댓값 | 모든 데이터        |
| MIN   | 속성 값의 최솟값 | 모든 데이터        |
| SUM   | 속성 값의 합계  | 숫자 데이터        |
| AVG   | 속성 값의 평균  | 숫자 데이터        |


집계 함수에는 두가지 특징이 있다.

1. 널인 속성을 제외한 검색을 수행한다.
2. WHERE절에는 사용 할수 없다.

<br><br>

### 그룹별 검색

---

테이블에서 특정 속성의 값이 같은 투플을 모아 그룹을 만들고, 그룹별로 검색을 하기 위해서 **GROUP BY** 키워드를 사용하게 된다.
**GROUP BY** 속성은 **HAVING** 키워드와 같이 사용하게 된다.


````sql
SELECT [ ALL | DISTINCT ] 속성리스트
FROM 테이블_리스트;
[WHERE 조건]
[GROUP BY 속성리스트 [ HAVING 조건]]
[ORDER BY 속성리스트 [ ASC | DESC]];
````

그룹화만 진해하게 된다면
````sql
GROUP BY 제조업체
````
이런식으로 사용하면 되지만 만약 그룹화를 하기 위한 조건이 필요하게 되면
````sql
GROUP BY 제조업체 HAVING count(*)>=3;
````
이렇게 HAVING 절 뒤에 조건을 작성하면 된다.

<br><br>

### 여러 테이블에 대한 조인 검색

---

조인을 쿼리문으로 진행하는 방법은 두가지가 있다.

### 1. where절에서 조인 속성과 그와 대응되는 속성을 동등 연산

### 2. JOIN 질의문 사용

<br>

1번부터 확인하게 되면

````sql
SELECT 제품, 제품명
FROM 제품, 주문
WHERE 주문.주문고객 = 'banana' AND 제품.제품번호 = 주문.주문제품;
````

주문고객이 banana인 경우 제품테이블과 주문테이블의 번호가 같은 것을 조인후 검색하는 방법이 있다.

<br><br>

2번을 확인하게 되면

````sql
SELECT 제품, 제품명
FROM 제품 INNER JOIN 주문 ON 주문.주문고객 = 'banana';
````
로 JOIN 명령어를 통해 진행하는 방식이 있다.

여기서 INNER JOIN은 예시이며 , 왼쪽 외부 조인, 오른쪽 외부 조인, 완전 외부 조인등 선택해서 사용할 수 있다.


<br><br>


## 3-2 데이터 삽입

---

테이블에 새로운 투플을 삽입하기 위해서는 필요한 SQL 문은 INSERT이다.

````sql
INSERT
INTO 테이블이름[(속성리스트)]
VALUES (속성값리스트)
````

### 예시

````sql
INSERT
INTO 고객(고객아이디, 고객이름, 나이, 등급, 직업, 적립금)
VALUES ('apple', '임직찬','25','vip','학생','1000')
````

처럼 해당하는 값을 넣어주면 돤다.

<br><br>


## 3-3 데이터 수정

---

테이블에 저장된 데이터를 수정하기 위해서는 UPDATE 명령어를 사용한다.

````sql
UPDATE 테이블이름
SET 속성이름 = 값, 속성이름2 = 값2,...
[WHERE 조건]
````
위와같은 형식으로 데이터 수정을 시행한다.

### 예시
> 제품 테이블에서 제품번호가 p03인 제품의 제품명을 통큰파이로 수정해보자

````sql
UPDATE 제품
SET 제품명 = '통큰파이'
WHERE 제품번호 = 'p03';
````

<br><br>


## 3-4 데이터 삭제

---

테이블에 저장된 데이터를 삭제하기 위해 DELETE 쿼리문을 사용한다.

````sql
DELETE
FROM 테이블
[WHERE 조건]
````











